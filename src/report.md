## Part 1. Установка ОС

**== Задание ==**

**Установи Ubuntu 20.04 Server LTS без графического интерфейса. (Используем программу для виртуализации - VirtualBox)**

Скачиваем образ Ubuntu 20.04 Server LTS на официальном сайте Ubuntu https://ubuntu.com/download/server.

Создаем новую виртуальную машину в VirtualBox.

![](./images/1.1.png)
![](./images/1.2.png)
![](./images/1.3.png)
![](./images/1.4.png)

Настраиваем виртуальную машину.

В разделе "Система" проверяем, что опция "Включить EFI" включена.

![](./images/1.5.png)

В разделе "Носители" добавляем скаченный ISO-образ.

![](./images/1.6.png)

В разделе "Сеть" ставим тип подключения "Сетевой мост", чтобы в дальнейшем иметь возможность работать через дескнопную версию Ubuntu.

![](./images/1.7.png)

Установку ssh производим непосредственно во время запуска машины на этапе загрузки дополнительных программ. Если вы этого не сделали, тогда установите в уже запустившейся машине.

С помощью команды ip addr show смотрим адрес.

В дальнейшем для удобства и комфорта вся работа будет выплняться десктопной версии Ubuntu.

![](./images/1.8.png)

Далее в десктопной версии Ubuntu подключаемся к нашей виртуальной машине через ssh. Проверяем версию Ubuntu, для этого отобразим в консоль файл, который содержит информацию о версии операционной системы.

![](./images/1.9.png)

## Part 2. Создание пользователя

**== Задание ==**

**Создай пользователя, отличного от созданного при установке. Пользователь должен быть добавлен в группу adm.**

Создаем нового пользователя. Используем команду sudo adduser.

- sudo - это комнада, которая позволяет выполнять команды с правами суперпользователя. Это необходимо для выполнения операций, требующих повышенных привилегий.

- adduser - это скрипт, который автоматизирует процесс создания нового пользователя, включая создание домашнего каталога и установку пароля.

![](./images/2.1.png)

Используя команду sudo usermod добавляем пользователя в группу adm.

- usermod - это команда для изменения параментров пользователя.

- -aG - это опция, которая добавляет пользователя в группу. -a означает "append" (добавить), а -G указывает на группу.

Проверяем создание пользователя и его принадлежность к группе adm. Выводим содержимое файла, который содержит информацию о всех пользователях системы. Отображаем все группы, к которым принадлежит пользователь.

![](./images/2.2.png)

## Part 3. Настройка сети ОС

**== Задание ==**

**Задай название машины вида user-1.**

Меняем имя машины с linux на user-1. Исаользуем команду sudo hostnamectl set-hostname.

- hostnamectl — утилита для управления настройками хоста.

- set-hostname — команда для установки нового имени хоста.

Мы можем увидеть, что изменения произошли из вывода команды hostnamectl. Так как сейчас я не перезапускала машину, имя хоста не изменилось в приглашении.

![](./images/3.1.png)

**Установи временную зону, соответствующую твоему текущему местоположению.**

Устанавливаем временную зону с помощью команды sudo timedatectl set-timezone.

- timedatectl — утилита для управления системными настройками времени и даты.

- set-timezone — команда для установки временной зоны.

![](./images/3.2.png)

**Выведи названия сетевых интерфейсов с помощью консольной команды.**

Выводим название сетевых интерфейсов с помощью команды ip link show.

- ip — утилита для управления сетевыми настройками.

- link show — команда для отображения всех сетевых интерфейсов.

![](./images/3.3.png)

lo — это loopback интерфейс, который используется для тестирования сетевых соединений на локальном компьютере. Он всегда имеет IP-адрес 127.0.0.1.

**Используя консольную команду, получи ip адрес устройства, на котором ты работаешь, от DHCP сервера.**

Получим ip-адрес с помощью команды ip addr show.

- addr - команда для управления и отображения адресов сетевых интерфейсов.

- show - команда для отображения текущих настроек.

![](./images/3.4.png)

DHCP (Dynamic Host Configuration Protocol) — протокол, который автоматически назначает IP-адреса и другие сетевые параметры устройствам в сети.

**Определи и выведи на экран внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw).**

Выводим внутренний и внешний ip-адреса шлюза с помощью команд ip route show default и curl ifconfig.me, соответственно.

- route - команда для управления таблицей маршрутизации.

- default - указывает, что нужно отобразить маршрут по умолчанию.

- curl - утилита для передачи данных с использованием различных сетевых протоколов.

- ifconfig.me - URL веб-сервиса, который возвращает внешний IP-адрес устройства, с которого был сделан запрос.

![](./images/3.5.png)

**Задай статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (используй публичный DNS серверы, например 1.1.1.1 или 8.8.8.8).**

Открываем файл конфигурации сети для Netplan.

- dhcp4: no — отключение DHCP.

- addresses — статический IP-адрес.

- gateway4 — шлюз по умолчанию.

- nameservers — DNS-серверы.

![](./images/3.6.png)

Применяем конфигурацию командой sudo netplan apply.

![](./images/3.7.png)

**Перезагрузи виртуальную машину. Убедись, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте.**

Перезагружаем машину комнадой sudo reboot. После этого наш ssh-клиент закрывается, необходимо дождаться перезагрузки машины и подключить через ssh заново.

![](./images/3.8.png)

Проверяем наши настройки. Для проверки настроек DNS выводим в консоль файл /etc/resolv.conf, который содержит настройки DNS-серверов.

![](./images/3.9.png)

Пингуем удаленные хосты с помощью команды ping.

- -c 4 — опция для отправки 4 пакетов.

![](./images/3.10.png)

## Part 4. Обновление ОС

**== Задание ==**

**Обнови системные пакеты до последней на момент выполнения задания версии.**

Обновляем системные пакеты командами sudo apt update
и sudo apt upgrade.

- apt - утилита для управления пакетами в Ubuntu.

- update - обновляет список доступных пакетов и их версий из репозиториев.

- upgrade - обновляет все установленные пакеты до последних версий, доступных в репозиториях.

![](./images/4.1.png)

Удаляем ненужные пакеты и очищаем кэш.

- autoremove- удаляет пакеты, которые были установлены автоматически для удовлетворения зависимостей других пакетов, но больше не нужны.

- clean- очищает локальный кэш пакетов, чтобы освободить место на диске.

Повторяем команды обновления, чтобы убедиться, что обновления отсуствуют.

![](./images/4.2.png)

## Part 5. Использование команды sudo

**== Задание ==**

**Разреши пользователю, созданному в Part 2,выполнять команду sudo.**

Для того, чтобы разрешить пользователю выполнять команду sudo, необходимо отредактировать файл sudoers. Для этого используем команду sudo visudo, где visudo - команда для безопасного редактирования файла sudoers.

Находим строку

#User privilege specification

root ALL=(ALL:ALL) ALL

и добавляем строку

kynesber-2 ALL=(ALL:ALL) ALL.

- ALL=(ALL:ALL) ALL - указывает, что пользователь может выполнять любые команды от имени любого пользователя на любом хосте.

![](./images/5.1.png)

Проверим права sudo для пользователя. Для этого введем команду для переключения на нового пользователя и команду sudo whoami.

- sudo whoami: Команда, которая выполняется с правами суперпользователя и возвращает имя текущего пользователя. Если команда выполнена успешно, мы должны увидеть root.

![](./images/5.2.png)

Определение команды sudo дала в Part 2.

Меняем hostname с user-1 на user-2 таким же способом, как и в Part 3.

![](./images/5.3.png)

## Part 6. Установка и настройка службы времени

**== Задание ==**

**Настрой службу автоматической синхронизации времени.**

Установим и настроим systemd-timesyncd.

systemd-timesyncd — это служба, которая автоматически синхронизирует системное время с NTP-серверами.

Включим и запустим службу systemd-timesyncd.

- systemctl - утилита для управления системными службами и состоянием системы в systemd.

- enable - команда для включения службы, чтобы она автоматически запускалась при загрузке системы.

- start - команда для запуска службы.

- status - команда для проверки статуса службы.

![](./images/6.1.png)

Проверим текущие настройки времени и часового пояса командой timedatectl.

Проверим, что системное время синхронизировано с NTP-сервером командой timedatectl show. NTPSynchronized=yes указывает, что системное время синхронизировано с NTP-сервером.

![](./images/6.2.png)

## Part 7. Установка и использование текстовых редакторов

**== Задание ==**

**Установи текстовые редакторы VIM (+ любые два по желанию NANO, MCEDIT, JOE и т.д.)**

Устанавливаем текстовые редакторы vim, nano и mcedit.

- install - установка новых пакетов.

![](./images/7.1.png)

**Используя каждый из трех выбранных редакторов, создай файл test_X.txt, где X -- название редактора, в котором создан файл. Напиши в нём свой никнейм, закрой файл с сохранением изменений.**

Создаем файлы с использованием каждого редактора.

vim:

- Перейдем в режим вставки, нажав i.

- Вводим никнейм.

- Нажимаем Esc для выхода из режима вставки.

- Вводим :wq и нажимаем Enter для сохранения и выхода.

![](./images/7.2.png)

nano:

- Вводим никнейм.

- Нажимаем Ctrl + O для сохранения файла.

- Нажимаем Enter для подтверждения.

- Нажимаем Ctrl + X для выхода.

![](./images/7.3.png)

mcedit:

- Вводим никнейм.

- Нажимаем F2 для сохранения файла.

- Нажимаем F10 для выхода.

![](./images/7.4.png)

**Используя каждый из трех выбранных редакторов, открой файл на редактирование, отредактируй файл, заменив никнейм на строку «21 School 21», закрой файл без сохранения изменений.**

vim:

- Переходим в режим вставки, нажав i.

- Заменим никнейм на 21 School 21.

- Нажимаем Esc для выхода из режима вставки.

- Вводим :q! и нажимаем Enter для выхода без сохранения.

![](./images/7.5.png)

nano:

- Заменим никнейм на 21 School 21.

- Нажимаем Ctrl + X для выхода.

- Нажимаем N для отказа от сохранения изменений.

![](./images/7.6.png)

mcedit:

- Заменим никнейм на 21 School 21.

- Нажимаем F10 для выхода.

- Выбираем No для отказа от сохранения изменений.

![](./images/7.7.png)

**Используя каждый из трех выбранных редакторов, отредактируй файл ещё раз (по аналогии с предыдущим пунктом), а затем освой функции поиска по содержимому файла (слово) и замены слова на любое другое.**

Для начала отредактируем все файлы как в предыдущем пункте и сохраним.

vim:

Поиск слова:

- Вводим /21 и нажимаем Enter для поиска слова 21.

Замена слова:

Вводим :%s/21/School/g и нажимаем Enter для замены всех вхождений слова 21 на School.

![](./images/7.8.png)
![](./images/7.9.png)

nano:

Поиск слова:

- Нажимаем Ctrl + W для открытия окна поиска.

- Вводим 21 и нажимаем Enter для поиска слова 21.

Замена слова:

- Нажимаем Ctrl + \ для открытия окна замены.

- Вводим 21 в поле "Replace" и School в поле "With".

- Нажимаем A для замены всех вхождений.

![](./images/7.10.png)
![](./images/7.11.png)
![](./images/7.12.png)
![](./images/7.13.png)

mcedit:

Поиск слова:

- Нажимаем F7 для открытия окна поиска.

- Вводим 21 и выбираем "Найти все" для поиска слова 21.

Замена слова:

- Нажимаем F4 для открытия окна замены.

- Вводим 21 в поле "Search for" и School в поле "Replace with", нажимаем "Дальше".

- При подтверждении замены выбираем "Все".

![](./images/7.14.png)
![](./images/7.15.png)
![](./images/7.16.png)
![](./images/7.17.png)

## Part 8. Установка и базовая настройка сервиса SSHD

**== Задание ==**

**Установи службу SSHd.**

SSHD (SSH Daemon) — серверная часть протокола SSH, демон, который обрабатывает входящие SSH-соединения.

Проверяем установку службы SSHd.

![](./images/8.1.png)

**Добавь автостарт службы при загрузке системы.**

После установки включаем службу, чтобы она запускалась автоматически при загрузке системы.

![](./images/8.2.png)

**Перенастрой службу SSHd на порт 2022.**

Редактируем файл конфигурации SSH.

Находим строку с параметром Port 22 и изменем ее на Port 2022.

Если строка закомментирована, раскомментируйте ее.

![](./images/8.3.png)

После изменения конфигурации перезапускаем службу.

![](./images/8.4.png)

**Используя команду ps, покажи наличие процесса sshd. Для этого к команде нужно подобрать ключи.**

Для проверки процесса SSH можно использовать команду ps -ef | grep sshd.

Объяснение ключей:

- -e - показывает все процессы в системе.

- -f - полный формат вывода (full format).

![](./images/8.5.png)

**Перезагрузи систему.**

Перезагружаем систему.

Заново подключаемся к десктопной версии Ubuntu через ssh, но в этот раз дополнительно указываем порт подключения, так как мы поменяли порт в этой части.

![](./images/8.6.png)

После перезагрузки устанавливаем команду netstat.

netstat - это утилита командной строки, которая отображает различную информацию, связанную с сетью.

После этого выполним команду netstat -tan.

- -t - отображает только TCP-соединения.

- -a - показывает все соединения и порты, находящиеся в режиме прослушивания (LISTEN).

- -n - отображает адреса и порты в числовом формате, без преобразования в имена.

Объяснение значения столбцов вывода:

- tcp - тип протокола (TCP).

- 0 - количество байт в очереди отправки.

- 0 - количество байт в очереди приема.

- 0.0.0.0:2022 - локальный адрес и порт (где первая часть - IP, вторая - порт).

- 0.0.0.0:_ - удаленный адрес и порт (символ _ означает, что соединение может быть установлено с любым адресом).

- LISTEN - состояние соединения (служба прослушивает порт и ожидает входящих соединений).

![](./images/8.7.png)

## Part 9. Установка и использование утилит top, htop

**== Задание ==**

**Установи и запусти утилиты top и htop.**

top — интерактивная утилита командной строки для мониторинга системы в режиме реального времени. Отображает информацию о процессах, использовании CPU, памяти и другие системные данные.

htop — улучшенная альтернатива утилите top, предоставляющая более интуитивный интерфейс с поддержкой мыши, возможностями цветового выделения, сортировки, фильтрации и другими расширенными функциями.

Устанавливаем утилиты. У меня утилиты уже были установлены.

top:

- uptime - время работы системы с момента загрузки (это первая строка вывода, начинающаяся с "up").

- Количество авторизованных пользователей (в первой строке, отображается как "x users").

- Общая загрузка системы (load average) - показатель загруженности системы, представленный тремя числами, которые показывают среднюю нагрузку за последние 1, 5 и 15 минут (в первой строке, это три числа в конце первой строки).

- Общее количество процессов - во второй строке, отображается как "Tasks: x total".

- Загрузка CPU (отображается в строках, начинающихся с "%Cpu(s)"):

CPU (Central Processing Unit) — центральный процессор, основной электронный компонент компьютера, который выполняет машинные инструкции и обрабатывает данные. Часто его называют "мозгом" компьютера.

- us - процент времени CPU, используемого пользовательскими процессами.

- sy - процент времени CPU, используемого системными процессами.

- ni - процент времени CPU, используемого процессами с изменённым приоритетом.

- id - процент времени CPU в простое (idle).

- wa - процент времени CPU, проведённого в ожидании ввода/вывода.

- hi - время, потраченное на обработку аппаратных прерываний.

- si - время, потраченное на обработку программных прерываний.

- st - время, "украденное" гипервизором (для виртуальных машин).

- Загрузка памяти (строки, начинающиеся с "MiB Mem" и "MiB Swap").

MiB Mem — информация об оперативной памяти в мебибайтах.

MiB Swap — информация о файле подкачки (виртуальной памяти) в мебибайтах.

Эти параметры памяти показывают:

    - всего доступно памяти

    - сколько используется

    - сколько свободно

    - сколько используется для буферов/кэша

- PID процесса с наибольшим использованием памяти (в списке процессов нужно найти процесс с наибольшим значением в столбце %MEM).

PID (Process ID) — уникальный идентификационный номер процесса в системе.

- PID процесса с наибольшим использованием CPU (в списке процессов нужно найти процесс с наибольшим значением в столбце %CPU).

Для выхода из top нажмите клавишу 'q'.

![](./images/9.1.png)

htop:

Сортировка по PID: нажимаем F6, выбираем PID и нажимаем Enter.

![](./images/9.2.png)

Сортировка по PERCENT_CPU: нажимаем F6, выбираем CPU% и нажимаем Enter.

![](./images/9.3.png)

Сортировка по PERCENT_MEM: нажимаем F6, выбираем MEM% и нажимаем Enter.

![](./images/9.4.png)

Сортировка по TIME: нажимаем F6, выбираем TIME и нажимаем Enter.

![](./images/9.5.png)

Фильтрация для процесса sshd:

Нажимаем F4, вводим "sshd" и нажимаем Enter. Программа покажет только процессы, содержащие "sshd" в имени. Для отмены фильтра нужно нажать Esc или F4 и очистить фильтр.

![](./images/9.6.png)

Поиск процесса syslog:

syslog — системный демон, отвечающий за сбор и запись системных логов (журналов).

Нажимаем F3, вводим "syslog" и нажимаем Enter. Программа подсветит первое совпадение. Используем F3 снова для поиска следующего совпадения.

![](./images/9.7.png)

Добавление дополнительной информации:

clock — текущее системное время.

Нажимаем F2 для входа в меню настроек. В первом столбце выбираем "Meters". В крайней правой колонке добавляем Clock и Hostname. Uptime уже был добавлен до меня.

Нажмите F10 или Esc чтобы вернуться.

![](./images/9.8.png)

Для выхода из htop нажмите клавишу 'q'.

## Part 10. Использование утилиты fdisk

**== Задание ==**

**Запусти команду fdisk -l.**

fdisk — утилита командной строки в Unix/Linux системах, предназначенная для управления разделами дисков. Позволяет создавать, удалять, изменять, просматривать и копировать разделы на физических дисках.

Сектор (Sector) — минимальная единица хранения данных на диске. Традиционно размер одного сектора составляет 512 байт, но в современных дисках может быть 4096 байт (4 КБ).

Swap (файл подкачки) — пространство на диске, которое используется операционной системой как виртуальная память, когда физической оперативной памяти недостаточно. Swap обычно представлен в виде раздела диска или специального файла.

Чтобы получить информацию о жестких дисках в системе, нужно выполнить sudo fdisk -l. Права суперпользователя (sudo) необходимы, так как обычному пользователю не разрешено получать полную информацию о дисковых устройствах.

Информация о swap не указана явн в выводе, опэтому используем дополнительную команду swapon --show.

![](./images/10.1.png)

- Название жёсткого диска: /dev/sda

- Размер жёсткого диска: 25 GiB

- Количество секторов: 52428800

- Размер swap: 2G

## Part 11. Использование утилиты df

**== Задание ==**

**Запусти команду df.**

df (disk free) — утилита командной строки в Unix/Linux системах, которая отображает информацию о доступном и используемом дисковом пространстве в файловой системе.

![](./images/11.1.png)

**Запусти команду df -Th.**

-T — показывает тип файловой системы для каждого раздела.

-h (human-readable) — отображает размеры в более удобном для человека формате (КБ, МБ, ГБ), а не в блоках.

![](./images/11.2.png)

ext4 — Fourth Extended Filesystem, стандартная файловая система для многих дистрибутивов Linux.

## Part 12. Использование утилиты du

**== Задание ==**

**Запусти команду du**

du (disk usage) — утилита командной строки в Unix/Linux системах, которая показывает количество дискового пространства, используемого файлами и директориями.

![](./images/12.1.png)

**Выведи размер папок /home, /var, /var/log (в байтах, в человекочитаемом виде)**

/home — директория, содержащая домашние каталоги пользователей системы, где хранятся их личные файлы и настройки.

/var — директория, содержащая переменные данные, которые часто изменяются во время работы системы (логи, временные файлы, кэши, базы данных и др.).

/var/log — поддиректория в /var, которая содержит системные журналы (логи) — записи о событиях и действиях, происходящих в системе.

Для вывода размера в байтах используется опция --bytes или -b.

![](./images/12.2.png)
![](./images/12.3.png)

**Выведи размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя \*)**

![](./images/12.4.png)

## Part 13. Установка и использование утилиты ncdu

**== Задание ==**

**Установи утилиту ncdu**

ncdu (NCurses Disk Usage) — это утилита с текстовым интерфейсом для анализа использования дискового пространства. Она позволяет удобно просматривать, какие файлы и директории занимают больше всего места на диске.

Устанавливаем утилиту.

![](./images/13.1.png)

**Выведи размер папок /home, /var, /var/log**

![](./images/13.2.png)
![](./images/13.3.png)
![](./images/13.4.png)

## Part 14. Работа с системными журналами

**== Задание ==**

**Открой для просмотра:**

**1. /var/log/dmesg**

**2. /var/log/syslog**

**3. /var/log/auth.log**

/var/log/dmesg - это файл, который содержит сообщения ядра, которые генерируются при загрузке системы. Эти сообщения могут включать информацию о подключенных устройствах, ошибках и других событиях, связанных с ядром.

![](./images/14.1.png)

less — утилита для просмотра содержимого файлов постранично.

/var/log/syslog - это файл, который содержит системные сообщения, включая информацию о различных событиях, таких как запуск и остановка служб, ошибки и предупреждения.

![](./images/14.2.png)

/var/log/auth.log - это файл, который содержит информацию о событиях аутентификации, таких как входы в систему, попытки входа и другие действия, связанные с аутентификацией.

![](./images/14.3.png)

Для поиска информации о последней успешной авторизации воспользуемся поиском внутри less через /. Введем ключевое слово "Accepted".

![](./images/14.4.png)

Время последней успешной авторизации: Mar 1 16:28:14

Имя пользователя: kynesber

Метод входа в систему: ssh

Перезапускаем SSHD.

Для поиска сообщения о рестарте службы воспользуемся утилитами для работы с текстами grep и tail.

tail - утилита для вывода последних строк файла.

-n - опция, которая указывает количество строк, которые нужно вывести.

![](./images/14.5.png)

## Part 15. Использование планировщика заданий CRON

**== Задание ==**

**Используя планировщик заданий, запусти команду uptime через каждые 2 минуты.**

Cron — это планировщик заданий в Unix-подобных операционных системах, который позволяет запускать команды или скрипты в заданное время или с заданной периодичностью.

Используем команду crontab -e для открытия файла crontab текущего пользователя в текстовом редакторе.

Добавим задания для запуска команды uptime каждые 2 минуты.

- \*/2 — запускать каждые 2 минуты.

- \* \* \* \* — запускать в любой час, день месяца, месяц и день недели.

- /usr/bin/uptime — полный путь к команде uptime.

![](./images/15.1.png)

Для поиска строк в файле /var/log/syslog, содержащих слово "uptime", будем использовать grep.

![](./images/15.2.png)

Используем команду crontab -l для вывода списка текущих заданий для cron.

![](./images/15.3.png)

**Удали все задания из планировщика заданий.**

Для удаления всех заданий из crontab будем использовать команду crontab -r. Для подтверждения еще раз выполним crontab -l.

![](./images/15.4.png)
